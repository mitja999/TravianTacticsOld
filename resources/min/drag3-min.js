var offlinebot=false;var offlineanaliza=false;var offlinebot=false;var dragSrcEl=null;function handleDragStart(a){this.style.opacity="0.4";dragSrcEl=this;a.dataTransfer.effectAllowed="move";a.dataTransfer.setData("text/html",this.innerHTML);a.elementtransfered=this}function handleDragOver(a){if(a.preventDefault){a.preventDefault()}a.dataTransfer.dropEffect="move";return false}function handleDragEnter(a){if(this.parentNode.getAttribute("class")==dragSrcEl.parentNode.getAttribute("class")){this.classList.add("over")}else{}}function handleDragLeave(a){this.classList.remove("over")}function handleDrop(j){if(j.stopPropagation){j.stopPropagation()}if(dragSrcEl!=this){var g=dragSrcEl.parentNode.getAttribute("class");var f=this.parentNode.getAttribute("class");if(g!=f){return}var k=dragSrcEl.parentNode.getAttribute("id").match(/[\d\.]+/g)[0];var d=this.parentNode.getAttribute("id").match(/[\d\.]+/g)[0];if(k!=d){alert("You cant move tasks between villages!");return}var a=document.createElement(dragSrcEl.nodeName);var h=dragSrcEl.parentNode.getAttribute("class");var b=dragSrcEl.childNodes.length;var m=[];for(var c=0;c<b;c++){if(dragSrcEl.childNodes[0].nodeName.toLowerCase()=="div"){m.push(dragSrcEl.childNodes[0].getElementsByTagName("input")[0].getAttribute("id").match(/[\d\.]+/g)[0]*1)}a.appendChild(dragSrcEl.childNodes[0])}dragSrcEl.innerHTML="";b=this.childNodes.length;var l=[];for(var c=0;c<b;c++){if(this.childNodes[0].nodeName.toLowerCase()=="div"){l.push(this.childNodes[0].getElementsByTagName("input")[0].getAttribute("id").match(/[\d\.]+/g)[0]*1)}dragSrcEl.appendChild(this.childNodes[0])}zamenjajElementa(m,l,k,h);this.classList.remove("over");this.innerHTML="";b=a.childNodes.length;for(var c=0;c<b;c++){this.appendChild(a.childNodes[0])}a=null}return false}function zamenjajElementa(k,g,d,b){if(b=="FARMLISTS"){var c=PLAYER.FARMLISTE}else{var c=PLAYER.getVillage(d)[b]}var j=-1;var f=-1;for(var a=0;a<c.length;a++){if(c[a].tasknumber==k[0]){j=a}else{if(c[a].tasknumber==g[0]){f=a}}}var h=[];for(var a=0;a<k.length;a++){h.push(c[j+a])}var e=[];for(var a=0;a<g.length;a++){e.push(c[f+a])}if(j>f){c.splice(j,k.length);for(var a=0;a<e.length;a++){c.splice(j+a,0,e[a])}c.splice(f,g.length);for(var a=0;a<h.length;a++){c.splice(f+a,0,h[a])}}else{c.splice(f,g.length);for(var a=0;a<h.length;a++){c.splice(f+a,0,h[a])}c.splice(j,k.length);for(var a=0;a<e.length;a++){c.splice(j+a,0,e[a])}}}function handleDragEnd(a){this.style.opacity="1";PrikazCheckboxov(this.parentNode)}function PrikazCheckboxov(b){var c=document.evaluate(".//input[@tip='checkboxzdruzi']",b,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(var a=0;a<c.snapshotLength;a++){if(a==0){c.snapshotItem(a).parentNode.style.display="none"}else{c.snapshotItem(a).parentNode.style.display=""}}}function EventVstopMiske(a){if(this.parentNode.parentNode.getAttribute("class")==dragSrcEl.parentNode.getAttribute("class")){this.parentNode.classList.add("over")}else{}}function EventIztopMiske(){this.parentNode.classList.remove("over")}function dodajEventDrag(){var c=document.evaluate(".//input[@tip='checkboxzdruzi']",document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(var a=0;a<c.snapshotLength;a++){c.snapshotItem(a).addEventListener("click",zdruziCheckboxHandler,false)}var c=document.evaluate(".//input[@tip='task']",document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(var a=0;a<c.snapshotLength;a++){c.snapshotItem(a).addEventListener("click",izbrisiTask,false)}var b=document.querySelectorAll("#columns1 .column1");[].forEach.call(b,function(d){d.addEventListener("dragstart",handleDragStart,false);d.addEventListener("dragenter",handleDragEnter,false);d.addEventListener("dragover",handleDragOver,false);d.addEventListener("dragleave",handleDragLeave,false);d.addEventListener("drop",handleDrop,false);d.addEventListener("dragend",handleDragEnd,false);for(var e=0;e<d.childNodes.length;e++){d.childNodes[e].addEventListener("dragover",EventVstopMiske,false);d.childNodes[e].addEventListener("dragleave",EventIztopMiske,false);d.childNodes[e].addEventListener("drop",EventIztopMiske,false)}})}function izbrisiTask(){var a=this.parentNode;var l=a.previousSibling;var d=a.nextSibling;var k=a.parentNode;var b=this.getAttribute("id").match(/[\d\.]+/g)[0];k.removeChild(a);var j=k.getAttribute("villageid");var g=k.parentNode;var f=g.getAttribute("class");if(k.childNodes.length>0){try{k.removeChild(l)}catch(c){try{k.removeChild(d)}catch(c){}}}else{g.removeChild(k)}PrikazCheckboxov(g);var h=PLAYER.getVillage(j)[f];for(var e=0;e<h.length;e++){if(h[e].tasknumber==b){h.splice(e,1);break}}}var skupajgombov=4;function zdruziCheckboxHandler(){var k=this.parentNode.parentNode;var q=this.parentNode.parentNode.parentNode;var g=this.getAttribute("tasknumber");var c=this.parentNode.parentNode.parentNode.getAttribute("villageid");var d=this.parentNode.parentNode.parentNode.parentNode.getAttribute("class");if(d=="FARMLISTS"){var x=PLAYER.FARMLISTE}else{var x=PLAYER.getVillage(c)[d]}for(var n=0;n<x.length;n++){if(x[n].tasknumber*1==g*1){x[n].joinwithprevious=this.checked;if(d=="FARMLISTS"){var u=0;var a=x[n];while(a!=false&&u<100){u++;if(!a.joinwithprevious){break}a=PLAYER.previousFarmlist(a.lid)}u=0;var h=PLAYER.nextFarmlist(a.lid);while(h!=false&&u<100){u++;if(!h.joinwithprevious){break}var l=["zadnjireportpozidivnidonos","zadnji5reportpozidivnidonos","troopshome","intervalmin","intervalmax","analysereportsbeforesending"];for(var p=0;p<l.length;p++){console.log(l[p]);h[l[p]]=a[l[p]]}var w=document.evaluate(".//img[@lid='"+h.lid+"'][@src='http://shrani.si/f/2i/bv/3NfnnqDh/1/repeattime.png']",document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);if(w.snapshotLength){w.snapshotItem(0).title=prevodi.translate17+" "+h.intervalmin+"-"+h.intervalmax+" "+prevodi.translate18;w.snapshotItem(0).alt=prevodi.translate17+" "+h.intervalmin+"-"+h.intervalmax+" "+prevodi.translate18}var w=document.evaluate(".//img[@lid='"+h.lid+"'][@src='http://shrani.si/f/3k/ld/2E6bBwx7/1/home.png']",document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);if(w.snapshotLength){w.snapshotItem(0).title=prevodi.translate136+": "+h.troopshome.join(",");w.snapshotItem(0).alt=prevodi.translate136+": "+h.troopshome.join(",")}h=PLAYER.nextFarmlist(h.lid)}}}}if(this.checked){var e=q.previousSibling;for(var r=0;r<50;r++){try{if(e.nodeName=="#text"){e=e.previousSibling}else{break}}catch(j){return}}var m=k;for(var r=0;r<50;r++){try{var f=document.createElement("hr");f.setAttribute("style","width:100%;margin:0px;");f.addEventListener("dragover",EventVstopMiske,false);f.addEventListener("dragleave",EventIztopMiske,false);f.addEventListener("drop",EventIztopMiske,false);var v=m.nextSibling.nextSibling;e.appendChild(f);e.appendChild(m);m=v}catch(b){e.appendChild(f);e.appendChild(m);break}}q.parentNode.removeChild(q)}else{try{if(this.parentNode.parentNode.previousSibling==null){return}}catch(j){return}var y=document.createElement("div");y.setAttribute("class","column1");y.setAttribute("draggable","true");y.setAttribute("villageid",c);y.addEventListener("dragstart",handleDragStart,false);y.addEventListener("dragenter",handleDragEnter,false);y.addEventListener("dragover",handleDragOver,false);y.addEventListener("dragleave",handleDragLeave,false);y.addEventListener("drop",handleDrop,false);y.addEventListener("dragend",handleDragEnd,false);for(var r=0;r<y.childNodes.length;r++){y.childNodes[r].addEventListener("dragover",EventVstopMiske,false);y.childNodes[r].addEventListener("dragleave",EventIztopMiske,false);y.childNodes[r].addEventListener("drop",EventIztopMiske,false)}if(q.nextSibling){q.parentNode.insertBefore(y,q.nextSibling)}else{q.parentNode.appendChild(y)}var m=k;for(var r=0;r<50;r++){try{var v=m.nextSibling.nextSibling;if(r!=0){var s=m.previousSibling;y.appendChild(s)}else{m.previousSibling.parentNode.removeChild(m.previousSibling)}y.appendChild(m);m=null;m=v}catch(b){if(r!=0){var s=m.previousSibling;y.appendChild(s)}else{m.previousSibling.parentNode.removeChild(m.previousSibling)}y.appendChild(m);break}}}try{if(m.parentNode.parentNode.getAttribute("class")=="FARMLISTS"){var t=m.parentNode.getElementsByClassName("editfarmlist");for(var r=0;r<t.length;r++){if(r<skupajgombov){t[r].style.display=""}else{t[r].style.display="none"}}}}catch(j){console.log("err")}}function handleDragEnterHeader(a){}function handleDragLeaveHeader(a){};